---
id: L-110
date: 2026.02.24
category: NODE
title: '使用 Cloudflare 优选 IP 拯救垃圾线路'
readTime: 6 MIN
preview: '利用 Cloudflare CDN 及优选 IP 工具，提升普通或较差 VPS 线路的回国速度与稳定性。'
tags:
  - cloudflare
  - network
  - optimization
  - cdn
---
# 使用 Cloudflare 优选 IP 拯救垃圾线路

## 垃圾线路的痛点

便宜的境外 VPS 往往存在回国路由差、晚高峰丢包严重、延迟极高等问题。如果不打算购买昂贵的优化线路（如 CN2 GIA/9929），我们可以白嫖 Cloudflare (CF) 庞大的免费 CDN 网络，利用“优选 IP”技术来大幅改善连接质量。

## 核心原理

默认情况下 CF CDN 分配给免费用户的节点经常绕路或拥堵。

**优选 IP** 的核心是“反客为主”：
跳过本地默认的 DNS 解析，借助测速工具筛选出当前网络环境下延迟最低、速度最快的 CF 节点 IP。客户端直接向该优质 IP 发起连接，再通过修改伪装域名（SNI/Host），告知 CF 将流量准确转发至你的真实服务器。

## 具体实施步骤

### 1. 域名托管并开启 CDN（橙色小云朵）

1. 登录 Cloudflare 控制台：[https://dash.cloudflare.com/](https://dash.cloudflare.com/)
2. 进入你在 Cloudflare 上托管的域名管理界面。
3. 点击左侧菜单栏的 **DNS -> Records** 选项。
4. 在 DNS 记录管理区域点击 **Add record**。
5. 添加一条 `A` 记录：
   - **Name**: 随意填写一个前缀（例如：`xyz`）。假设你的域名为 `abcdefg.com`，那么最终解析的子域名就是 `xyz.abcdefg.com`。
   - **IPv4 address**: 填入你的 VPS 的真实公网 IP。
   - **Proxy status**: 必须开启代理（点亮橙色小云朵图标）。

### 2. VPS 服务端配置

这里以 `fscarmen` 的 sing-box 全家桶脚本为例进行部署：

```bash
bash <(wget -qO- https://raw.githubusercontent.com/fscarmen/sing-box/main/sing-box.sh)
```

1. 运行上面的一键脚本后，语言选择输入 `1`（中文等预设语言）。
2. 安装模式选择：`Install Sing-box + subscribe ( Additional dependencies: nginx )`。
3. 协议组合选择：`vless + ws + tls`。
4. 端口和 VPS IP 选项直接回车保持默认即可（脚本默认的 vless 协议端口为 `8881`）。
5. **关键点！** 当提示 `Please enter the VLESS domain name:` 时，输入你在上一步解析的子域名，例如：`xyz.abcdefg.com`。
6. 剩下的选项一律回车保持默认直到安装完成。

> **注意**：以下以 v2rayN 客户端为例进行说明。

7. 安装完成后，复制终端输出中 v2rayN 方框下的订阅链接，并在 v2rayN 中通过“从剪贴板导入”添加该节点。
8. **此时无需关注节点是否能连通**。右键节点查看配置，我们主要需要从中获取对应节点的 **UUID（用户ID）** 和 **路径（Path）** 等核心信息，以备后续提取使用。

### 3. Cloudflare 端口转发规则（Origin Rules）

如果你的服务端节点使用了非标准 HTTPS 端口（例如脚本默认生成的 `8881` 端口），需要在 Cloudflare 中配置 **Origin Rules**，将回源请求重定向到该端口：

> 在 Cloudflare 域名面板左侧菜单中进入 **Rules -> Origin Rules**，点击 **Create Rule**：
> - **Field** 选择 `Hostname`
> - **Operator** 选择 `equals`
> - **Value** 填入你解析的子域名（如 `xyz.abcdefg.com`）
> - 在 Destination port 重写目标端口区域，填写服务端实际监听的端口（此处使用脚本默认的 vless 协议端口 `8881`）。

### 4. 使用优选脚本在线生成订阅

访问在线优选节点生成工具：[https://yx-auto-81b.pages.dev](https://yx-auto-81b.pages.dev/)

在页面中填写刚才获取到的三大核心参数：
- **域名**：填入你的子域名（如 `xyz.abcdefg.com`）
- **UUID**：填入从原订阅链接中提取的 UUID
- **路径 (Path)**：填入从原订阅链接中提取的 WebSocket 路径
- **TLS**：勾选下方对应选项

填写完毕后，在底部的客户端选项中选择 **V2ray** 以生成优选订阅链接。复制该链接，进入 v2rayN 或其他客户端，选择从剪贴板导入，更新订阅后即可使用经过优选 IP 加速的节点。

---

> **参考资源**：本笔记主要记录了基于 `fscarmen` sing-box 脚本的流程。关于优选 IP 原理及基于 3x-ui 面板的类似操作逻辑，可以参考相关的 YouTube 视频教学：[https://www.youtube.com/watch?v=RiQCP0EJr-4](https://www.youtube.com/watch?v=RiQCP0EJr-4)
